close all;
N = 128;
% Mouth_xy=[ -42.80059814 91.22740173  -30.81559944 79.62740326  -20.36059952 72.37740326  -7.10063982 74.40740204  4.88434982 72.95739746  17.12439919 81.36740112  29.61940002 94.41729736  19.16440010 101.66799927  11.00440025 106.59799957  -6.84563017 108.62799835  -20.87059975 105.72799683  -30.81559944 100.21800232
%     -46.33119965 90.32140350  -36.71530151 78.26540375  -17.52059937 67.70050049  -6.90900993 70.74729919  5.27253008 67.78959656  20.01370049 75.75379944  37.06499863 91.25469971  25.62010002 109.05400085  14.20149994 117.21600342  -6.78869009 121.28199768  -22.83209991 115.67299652  -33.69070053 108.72200012
%     -44.71849823 89.73750305  -30.62380028 79.38739777  -17.30299950 72.83509827  -5.78775978 74.89089966  3.94252992 72.69259644  15.19709969 77.77980042  28.48730087 90.39589691  18.74500084 100.16000366  6.44890022 106.19000244  -6.86346006 107.44599915  -20.17130089 105.92700195  -31.67819977 98.57489777
%     -42.87429810 85.89969635  -29.65990067 78.17430115  -16.18190002 70.96140289  -6.93310022 72.86969757  5.46320009 71.62129974  16.32220078 77.89649963  32.49739838 87.69889832  19.83539963 97.48290253  7.25438023 101.06099701  -5.58937979 104.12699890  -22.36289978 99.76349640  -32.20800018 94.24629974
%     -43.38899994 84.36260223  -29.16799927 68.34680176  -17.21389961 61.87089920  -5.98877001 65.70189667  5.06718016 63.34999847  19.40229988 70.00620270  37.24100113 84.63950348  24.03910065 110.18499756  15.81960011 114.58899689  -3.73652005 120.31500244  -18.25469971 116.23600006  -32.72280121 104.68399811
%     -40.36510086 84.13790131  -31.15110016 75.15840149  -17.51140022 68.29969788  -7.52369022 73.62159729  5.03935003 66.78269958  18.25709915 72.04499817  33.66759872 86.66120148  22.79660034 96.18769836  12.81330013 99.57299805  -1.68254995 101.48300171  -10.01430035 98.64270020  -24.93390083 94.15509796
%     -65.52089691 70.82089996  -46.62129974 71.95010376  -30.15990067 67.91539764  -18.78000069 74.72869873  -8.95726967 71.04080200  4.68063021 78.79440308  27.56130028 89.63890076  14.15079975 97.68070221  -1.22774994 102.87100220  -14.83510017 105.26200104  -33.09809875 102.99099731  -42.40039825 92.89479828
%     -42.74060059 90.51640320  -26.30089951 80.51750183  -10.97410011 71.60639954  1.74435997 74.34829712  12.61919975 69.78839874  25.16769981 76.74250031  41.01269913 81.48619843  25.47349930 95.66249847  14.38619995 105.48799896  1.37030005 110.11699677  -14.47459984 105.37300110  -29.29159927 101.64800262
%     -44.00199890 86.54969788  -32.89739990 75.85790253  -22.67659950 70.68350220  -16.24239922 77.81230164  -2.60245991 70.57189941  12.79039955 76.62729645  29.07799911 88.81870270  16.59000015 95.02919769  2.91323996 103.29399872  -10.86019993 104.40499878  -24.64679909 100.07299805  -32.60179901 95.86150360
%     -47.10449982 85.78489685  -40.31280136 77.18029785  -31.35589981 71.07569885  -16.71520042 74.70980072  -7.03328991 73.39859772  6.84240007 80.79489899  21.11389923 90.29299927  11.69209957 98.01020050  -3.67121005 101.95600128  -14.79360008 105.55000305  -27.19330025 103.71600342  -41.24509811 100.14199829
%     -37.30120087 90.81150055  -25.47690010 84.52169800  -13.89439964 78.20480347  -3.12011003 83.35189819  7.07775021 80.29360199  17.64660072 84.62989807  30.56180000 96.05699921  20.14539909 103.55500031  9.35795021 108.64800262  -4.64924002 109.44100189  -16.43689919 104.96800232  -25.46579933 99.22889709
%     -40.61040115 84.18849945  -24.64150047 81.44409943  -13.28439999 77.60320282  -2.67715001 81.28029633  7.54465008 79.66049957  22.27619934 84.37380219  37.09360123 87.78530121  24.88229942 97.03160095  13.92809963 102.23500061  -3.61480999 102.68399811  -15.00909996 99.69719696  -25.91360092 93.09639740
%     -35.46210098 89.53140259  -22.35050011 83.20580292  -11.04349995 78.97160339  -1.91287994 83.23560333  8.09652042 80.64330292  19.76350021 86.78070068  30.40139961 94.07620239  21.40780067 104.02500153  13.91989994 108.74700165  -2.75798011 110.22899628  -13.12660027 106.58100128  -25.21159935 99.35910034
%     -36.94869995 89.71450043  -23.24250031 84.81300354  -11.39830017 81.41999817  -0.25988501 85.50099945  9.46177006 84.34639740  21.51119995 90.62950134  32.49810028 98.04060364  20.48049927 106.57800293  11.07600021 107.28399658  -1.11842000 108.10500336  -11.77060032 104.34300232  -23.66250038 100.15599823
%     -43.07320023 77.92379761  -26.20549965 72.40740204  -12.19929981 71.58149719  -3.79852009 74.80449677  6.96082020 73.26589966  22.44560051 76.72389984  39.69649887 83.99729919  26.86739922 100.78099823  17.14430046 109.34300232  -5.07398987 111.55799866  -21.38999939 105.43499756  -33.66529846 92.24140167
%     -42.98590088 85.65000153  -25.74250031 76.04019928  -14.61870003 71.07640076  -10.02509975 72.54570007  4.09582996 73.24009705  15.18610001 82.83580017  23.95660019 93.17340088  13.35280037 99.34089661  2.80435991 98.70020294  -10.11340046 102.82800293  -19.39399910 98.77200317  -34.36080170 92.52020264
%     -44.62229919 83.41190338  -24.82449913 84.18699646  -15.88269997 85.33820343  -11.94190025 87.24410248  -2.93978000 86.91259766  5.91097021 90.65219879  18.00009918 98.59239960  13.18970013 106.40299988  0.19028500 107.37400055  -13.59879971 108.29399872  -27.51329994 103.63300323  -33.62570190 94.98919678
%     -31.31640053 90.41290283  -22.93320084 87.19380188  -10.09340000 83.25009918  0.06014050 82.81220245  11.14830017 81.74289703  23.23509979 84.85540009  35.89329910 92.05899811  27.22960091 101.58300018  16.08020020 105.46199799  1.76724005 106.39299774  -7.69665003 104.79699707  -20.24710083 98.44560242
%     -32.85200119 97.31759644  -23.62269974 88.64119720  -9.61155987 84.86309814  -0.48333699 87.51329803  13.34889984 85.12860107  20.96870041 88.99250031  29.73929977 94.42949677  19.18040085 102.92600250  9.15799999 107.24299622  -5.37483978 109.85900116  -20.62919998 107.47299957  -28.07019997 102.21600342
%     -40.15879822 89.76180267  -29.79520035 84.48300171  -18.92130089 82.46089935  -6.36648989 83.38680267  5.83795023 81.65509796  24.43659973 89.61740112  38.34690094 93.61720276  24.50090027 93.05860138  15.79259968 99.99949646  -4.07416010 105.17500305  -20.44589996 101.75700378  -32.09109879 96.43849945
%     -37.11560059 88.65309906  -28.03829956 82.67939758  -22.91410065 75.52220154  -10.98169994 83.44029999  -3.22212005 77.07209778  9.61328983 86.70919800  25.92480087 95.86879730  15.51869965 100.06600189  6.02669001 107.36399841  -10.73120022 105.15699768  -21.57150078 103.44699860  -28.78700066 96.99729919
%     -38.93259811 91.96410370  -24.70560074 86.62409973  -13.32409954 82.35209656  -7.05974007 88.56629944  1.60705996 83.99549866  11.95489979 89.50599670  26.35219955 97.76869965  16.86529922 103.73000336  3.19717002 110.41300201  -9.54179001 114.53600311  -22.72369957 108.94100189  -30.16790009 100.40499878
%     -39.96720123 88.60890198  -28.67830086 88.48699951  -14.02719975 76.66480255  -4.66260004 79.35469818  7.49669981 77.72010040  19.92959976 88.18759918  34.06940079 95.63659668  25.07819939 103.05000305  10.74839973 105.50800323  -2.46193004 106.83100128  -16.75060081 101.89099884  -27.77160072 100.32199860
%     -38.94800186 88.69570160  -31.21969986 83.80310059  -16.44599915 82.40039825  -6.26099014 88.37229919  3.78971004 85.82790375  15.97379971 91.72139740  28.96339989 98.57890320  14.63630009 105.43399811  6.55966997 110.31999969  -8.41907024 112.34300232  -17.81389999 106.68099976  -28.59670067 98.74410248
%     -40.97819901 91.16570282  -28.67020035 87.15470123  -15.46669960 84.65370178  -6.44939995 90.52120209  6.77504015 87.01300049  16.83460045 93.03589630  27.22690010 97.40429688  15.74650002 108.70300293  8.49186039 113.24400330  -8.75296974 113.35099792  -18.94099998 110.92199707  -26.89430046 101.43399811
%     -41.41529846 94.64170074  -20.07340050 91.26470184  -10.75549984 91.98690033  -2.93024993 94.98870087  7.69327021 93.68520355  26.05870056 96.35019684  18.25530052 109.41100311  8.14910984 119.08699799  -5.47484016 120.41999817  -16.10960007 117.42800140  -23.85689926 111.67199707  -30.36380005 107.65499878
%     -47.14179993 89.68129730  -26.19070053 86.59660339  -13.28209972 85.58190155  -2.94180012 90.96730042  3.90344000 87.80210114  16.18969917 93.26290131  23.58480072 101.97000122  16.74869919 106.37300110  3.07704997 112.66699982  -8.01762009 112.55899811  -19.09889984 109.31099701  -29.63940048 100.50800323
%     -40.01359940 90.32700348  -25.46389961 88.85019684  -15.79469967 82.50250244  -9.56317043 92.91339874  -1.35794997 84.04799652  10.16460037 89.71119690  20.00110054 101.67700195  10.82849979 109.77799988  -2.05842996 113.68599701  -11.26900005 115.59200287  -21.45269966 109.22499847  -32.55289841 103.87300110
%     -39.24789810 94.87899780  -26.91230011 89.01820374  -15.90719986 85.91230011  -3.95966005 88.72679901  2.24045992 85.07350159  10.39039993 91.81490326  20.94269943 98.83010101  7.21191978 108.89199829  -2.59186006 112.13400269  -12.52499962 118.26899719  -22.00550079 114.28199768  -31.29190063 105.95800018
%     -44.94649887 90.47920227  -30.65780067 83.28230286  -18.83079910 74.30690002  -10.68799973 79.38130188  -1.90179002 77.61830139  10.76280022 80.44370270  29.76269913 92.28410339  20.71910095 96.78209686  12.02579975 105.83300018  -3.22871995 107.55300140  -18.16069984 102.98899841  -31.68589973 100.82099915
%     -38.58380127 96.09940338  -24.30669975 90.89050293  -13.78680038 87.86350250  -5.69284010 90.23870087  4.75854015 88.23229980  16.04540062 92.99140167  27.69050026 100.09999847  14.76179981 108.27400208  4.49808979 111.32700348  -5.88483000 112.31300354  -16.01079941 109.47100067  -24.00200081 105.56500244
%     -45.19419861 81.43139648  -26.50309944 87.57250214  -11.50959969 85.66760254  -4.90246010 88.68949890  5.69781017 86.04319763  21.64139938 90.09799957  38.14569855 89.12319946  25.99580002 100.25399780  13.99269962 104.52700043  -5.02744007 108.27799988  -19.15509987 104.42400360  -31.50130081 96.94840240
%     -39.48830032 89.02770233  -26.46389961 89.58619690  -13.40649986 86.61569977  -4.02876997 90.70339966  5.34593010 88.48049927  17.85510063 91.74359894  31.33320045 96.65730286  23.63190079 105.17299652  11.81680012 109.83200073  -5.18688011 110.23300171  -16.06959915 107.44899750  -28.61249924 101.40299988
%     -35.65359879 97.74250031  -21.87610054 89.87229919  -5.25600004 87.53780365  -0.80890101 88.66699982  8.01150990 87.82779694  24.76000023 91.94139862  35.70600128 99.62629700  24.59469986 107.35099792  14.14470005 108.73699951  0.61428499 108.41100311  -10.96220016 106.55500031  -21.91510010 103.24199677
%     -45.31150055 76.60500336  -28.70009995 73.56970215  -11.17269993 71.94280243  -3.70036006 73.59470367  5.52084017 73.48539734  28.13080025 76.44139862  42.16790009 83.66400146  30.89259911 102.22599792  16.60079956 111.19699860  -1.58385003 111.45500183  -16.60029984 108.90200043  -31.26250076 97.27210236
%     -39.47090149 95.29949951  -25.81879997 88.50129700  -18.89520073 84.04779816  -8.26601982 86.46600342  0.70538199 83.33959961  12.21230030 88.00289917  24.20669937 99.12879944  14.65030003 108.58100128  5.48391008 113.81600189  -6.51049995 114.42500305  -18.01740074 109.76100159  -30.79190063 107.06999969
%     -37.41790009 98.80169678  -24.63209915 89.57620239  -14.42819977 87.80690002  -4.96579981 92.57779694  2.38636994 88.90969849  18.37649918 93.74579620  26.08230019 102.23899841  14.17560005 109.60399628  4.07963991 115.11499786  -9.03190994 113.11399841  -19.39959908 109.26999664  -29.79409981 104.48999786
%     -33.43550110 92.95310211  -24.65690041 80.82849884  -16.61779976 76.93730164  -5.69637012 82.21260071  4.21124983 81.67819977  18.80669975 90.36319733  27.97240067 98.06300354  20.09580040 110.21399689  5.80742979 117.22299957  -8.59391022 118.44999695  -19.51650047 113.17500305  -29.61709976 103.79699707
%     -44.94459915 83.55200195  -27.99250031 83.56009674  -17.13330078 82.31230164  -8.54848957 86.15329742  -3.02958989 81.32129669  11.99940014 87.78009796  24.86540031 94.06759644  14.88669968 104.86900330  4.04973984 105.06500244  -10.07629967 107.10800171  -24.02370071 100.73500061  -34.74909973 95.67050171
%     -40.07320023 100.05000305  -24.23600006 92.13420105  -14.91119957 88.60780334  -6.47812986 91.19770050  4.70942020 86.79229736  16.89489937 91.11540222  33.76630020 97.16809845  23.50790024 100.69799805  9.54638958 109.48000336  -7.27577019 110.41300201  -19.44190025 108.70999908  -27.88780022 104.37300110
%     -37.99110031 96.63179779  -21.19409943 90.36640167  -5.36818981 83.00489807  3.85721993 87.93499756  11.91549969 82.77320099  24.92670059 82.10569763  43.76520157 88.01629639  25.41550064 99.10959625  17.26029968 105.25900269  6.09456015 109.10700226  -7.98477983 109.66500092  -22.55080032 104.19000244
%     -41.27510071 96.65209961  -27.54420090 93.33999634  -16.29089928 91.59660339  -8.83942986 98.53859711  -1.21733999 92.81580353  12.61740017 94.81939697  34.17810059 96.41600037  23.51090050 106.75700378  12.84360027 117.09899902  -5.94644022 118.23300171  -23.60149956 113.26699829  -33.15230179 105.86000061
%     -38.91059875 93.64450073  -27.59600067 89.58529663  -17.11149979 86.37860107  -7.07964993 89.29309845  7.10933018 87.94419861  16.43700027 93.46849823  36.18460083 94.90740204  19.23810005 107.56900024  9.71310997 111.68000031  -6.90808010 116.46499634  -22.62470055 109.00599670  -30.16169930 103.53399658
%     -46.41460037 92.15299988  -30.96730042 90.10810089  -17.46360016 89.07230377  -10.78590012 93.08470154  -2.01638007 87.02749634  7.58385992 89.01969910  21.95310020 94.02290344  16.04070091 102.08899689  6.35761976 105.12799835  -10.11859989 111.20300293  -22.59329987 108.20899963  -36.92879868 101.19200134
%     -43.88750076 98.17359924  -30.30010033 94.15940094  -19.23480034 96.01319885  -9.16075039 95.92690277  2.66997004 93.87660217  11.97859955 97.69429779  22.93110085 96.62650299  11.32509995 104.52100372  0.74875200 115.33000183  -11.99759960 117.38700104  -23.17480087 112.61100006  -34.42869949 105.88700104
%     -38.16880035 90.87770081  -25.40410042 84.31559753  -12.95989990 80.09459686  -2.29188991 85.21800232  5.93546009 82.00990295  16.14929962 85.93800354  30.22190094 92.37049866  15.86779976 102.40200043  5.37175989 107.28700256  -4.55728006 109.84100342  -13.50349998 104.78399658  -25.43910027 100.78900146
%     -45.83089828 81.05339813  -28.54990005 76.22239685  -14.23320007 73.15879822  -4.12740993 78.67880249  7.72046995 76.34480286  22.27219963 78.81719971  34.34920120 85.70279694  20.50550079 99.04540253  9.88214970 105.62400055  -5.42402983 109.97799683  -18.49650002 108.06999969  -30.57290077 100.91999817
%     -40.57320023 86.81109619  -28.94969940 81.58679962  -16.83839989 77.14450073  -3.13738990 82.51920319  7.22381020 77.78910065  20.44569969 81.86879730  33.42520142 85.42839813  22.41880035 98.65059662  12.25360012 106.73100281  -4.08954000 109.30300140  -18.56529999 105.20500183  -28.46260071 97.31390381
%     -40.76269913 90.62560272  -23.71859932 87.88320160  -11.51439953 84.01570129  -2.48152995 88.92720032  7.74734020 86.10679626  21.05949974 90.79989624  29.63209915 96.77300262  20.23900032 107.61599731  6.88227987 114.13899994  -4.97054005 114.27100372  -16.94440079 111.46399689  -27.05299950 104.93800354
%     -43.29079819 78.21970367  -27.73959923 72.55840302  -12.41240025 70.55229950  -0.81891900 75.31649780  9.66452980 71.97750092  28.30400085 74.16970062  39.41749954 79.19170380  32.21920013 92.99410248  23.34510040 104.43800354  -1.38156998 114.22799683  -19.42919922 109.95200348  -33.30260086 98.12329865
%     -37.39709854 90.62059784  -28.74720001 80.27809906  -18.12450027 74.68699646  -7.45465994 75.72440338  5.10682011 70.14920044  18.73299980 77.84040070  31.43700027 92.15080261  20.88220024 107.21299744  13.16769981 112.82800293  -5.19018984 121.19400024  -20.74099922 115.38099670  -28.57069969 104.89900208
%     -34.87620163 89.92019653  -30.12859917 78.52500153  -16.75839996 70.70629883  -8.17846966 71.87930298  0.44936800 66.56819916  14.26620007 75.31259918  25.29929924 92.38179779  15.82999992 107.00900269  13.02750015 111.46499634  -5.12480021 119.38800049  -20.43989944 116.89700317  -32.89739990 110.58000183
%     -42.25799942 85.08370209  -27.19809914 81.98819733  -20.18070030 77.68579865  -9.26469040 81.58769989  3.94319010 80.20490265  17.02720070 85.87329865  24.05590057 97.62280273  16.10460091 107.83899689  3.04222012 107.66600037  -6.99430990 110.82800293  -27.09480095 109.46199799  -34.16999817 98.37899780
%     -46.92129898 89.41950226  -26.71669960 81.64119720  -14.07810020 78.53540039  -6.20536995 81.89469910  3.54194999 80.92810059  13.44629955 88.66419983  19.93370056 97.25000000  16.30859947 105.23799896  3.25718999 109.38999939  -9.71621037 110.97799683  -25.28630066 106.67199707  -34.19499969 100.03600311
%     -27.93639946 95.60790253  -20.69440079 86.20400238  -11.07830048 79.18180084  4.56009007 81.82129669  12.23009968 79.47799683  22.12750053 88.04010010  36.56140137 85.56279755  26.31629944 100.00099945  18.73480034 105.62599945  9.19108963 110.19599915  -11.21689987 106.22399902  -19.12360001 99.81230164
%     -37.51359940 91.99440002  -31.96109962 83.72059631  -17.96570015 78.89669800  -7.40274000 86.05159760  -1.12567997 79.45300293  12.01000023 85.17340088  27.04680061 95.18499756  18.68029976 102.30899811  11.21850014 105.23400116  -1.52350998 106.58100128  -12.81289959 101.84300232  -23.43499947 98.80239868
%     -34.15309906 96.55940247  -21.15110016 85.64749908  -6.75742006 81.20600128  -1.98345006 86.71289825  11.38300037 82.90709686  23.56979942 88.41200256  32.93640137 93.90370178  21.37960052 102.13899994  17.52729988 107.63999939  2.12684011 114.02400208  -11.25559998 113.31199646  -23.33970070 104.67299652
%     -32.42829895 99.07170105  -24.03260040 87.42279816  -10.63119984 82.15339661  2.31570005 85.42829895  9.92693996 80.18309784  18.03070068 85.94270325  35.83160019 89.95839691  23.35689926 93.01409912  14.39929962 102.60399628  -1.96036005 109.68199921  -12.05830002 104.53500366  -22.56550026 98.92720032
%     -39.75030136 88.95459747  -30.31830025 83.54360199  -19.09199905 80.42350006  -12.65709972 82.82070160  -2.48014998 84.17859650  11.34819984 87.87180328  30.65159988 95.06539917  22.05579948 103.87200165  8.10604000 104.67900085  -5.96573019 109.98400116  -17.93759918 106.33399963  -30.74559975 99.28869629
%     -37.12179947 93.59279633  -25.54599953 87.14949799  -14.91380024 84.06479645  -5.94455004 88.37110138  2.93752003 85.47840118  12.81939983 91.80339813  20.06480026 96.13549805  16.56030083 106.76499939  6.81487989 108.52700043  -6.47980022 112.77100372  -18.18860054 108.72100067  -26.29899979 103.42199707
%     -36.59859848 100.38400269  -23.40349960 88.67199707  -12.05329990 86.10870361  -3.85334992 85.26789856  8.33475018 82.70279694  15.56579971 89.49160004  26.62280083 94.24060059  18.09269905 104.57099915  9.63671017 110.54299927  -2.53541994 116.74900055  -15.39449978 108.84899902  -23.66449928 103.92500305
%     ];
% newMouth_xy = zeros(64*10,24);
load('aligned.txt');
Mouth_xy = aligned;
% for i=1:61
%     cx = mean(Mouth_xy(i,1:2:N));
%     cy = mean(Mouth_xy(i,2:2:N));
%     Mouth_xy(i, 1:2:N) = Mouth_xy(i,1:2:N) - cx;
%     Mouth_xy(i, 2:2:N) = Mouth_xy(i,2:2:N) - cy;
% end
[V,D]=eig(cov(Mouth_xy));
mMesh = mean(Mouth_xy);
newV=[];
[lambda, I] = sort(diag(D),'descend');% 將特徵值 從大排到小
for j=1:N
    newV=horzcat(newV,V(:,I(j:j):I(j:j)));  %根據特徵值大小  將特徵向量從大排到小
end
thebestZ = Mouth_xy(41,:);
% thebestZ(1:2:N) = thebestZ(1:2:N) - mean(thebestZ(1:2:N));
% thebestZ(2:2:N) = thebestZ(2:2:N) - mean(thebestZ(2:2:N));
rand_thebestZ = thebestZ+50*rand(1,N);
% rand_thebestZ(1:2:N) = rand_thebestZ(1:2:N) - mean(rand_thebestZ(1:2:N));
% rand_thebestZ(2:2:N) = rand_thebestZ(2:2:N) - mean(rand_thebestZ(2:2:N));
d = (rand_thebestZ - mMesh);
dd = thebestZ-mMesh;
b = min(max(d*newV,-1.0*(lambda')),1.0*(lambda'));
% b = d*newV;
[val1, I1] = sort(abs(b),'descend');% 將特徵值 從大排到小
% bb = dd*newV;
% [val2, I2] = sort(abs(bb),'descend');% 將特徵值 從大排到小
% b = d*newV;
% bb = min(max(d*Mouth_vector',-1.732*lambda'),1.732*lambda');
% Matlab_Mouth = min(max(d * Mouth_vector',-1.732*lambda'),1.732*lambda');
% threshold = sum(lambda)*0.999;
% sum_lambda = 0;
% for kk=1:N
%     sum_lambda = sum_lambda + lambda(kk);
%     if (sum_lambda>threshold)
%         break;
%     end
% end
k = round(N*1);
recon1 = b(1:k) * newV(:,1:k)' + mMesh;
% recon2 = bb(1:k) * Mouth_vector(1:k,:) + mMesh;
% recon3 = Matlab_Mouth(1:k)*Mouth_vector(1:k,:)+mMesh;
spx0 = thebestZ(1:2:N);
spy0 = thebestZ(2:2:N);
spx1 = recon1(1:2:N);
spy1 = recon1(2:2:N);
diff = abs(spx0-spx1)+abs(spy0-spy1);
diff = reshape([diff;diff], 1, 2*length(diff));
ind = diff<=4;
 W = diag(1-(1+exp(-log(diff))).^(-1));
% W = eye(length(diff));
bbb = ConstrainedReconstruct(W, newV, (recon1-mMesh)', (recon1-mMesh)', -1.0*sqrt(abs(lambda)), 1.0*sqrt(abs(lambda)), ind);
recon2 = bbb(1:k)' * newV(:,1:k)' + mMesh;
mark = recon1(ind);
spx2 = rand_thebestZ(1:2:N);
spy2 = rand_thebestZ(2:2:N);
spx3 = recon2(1:2:N);
spy3 = recon2(2:2:N);
spx4 = mark(1:2:length(mark));
spy4 = mark(2:2:length(mark));
% spx2 = recon2(1:2:N);
% spy2 = recon2(2:2:N);
% spx3 = recon3(1:2:N);
% spy3 = recon3(2:2:N);
% plot(spx0, spy0, 'bx-', spx1, spy1,'ro-', spx2, spy2,'g*-');
plot(spx0, spy0, 'bx-', spx1, spy1,'r+:', spx2, spy2,'g*-', spx3, spy3,'k*--', spx4, spy4, 'o','LineWidth',2, 'markersize', 10);
axis ij;
axis equal;
